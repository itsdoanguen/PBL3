@using PBL3.ViewModels.UserProfile
@model UserProfileViewModel
@using Microsoft.AspNetCore.Mvc.Localization
@inject IViewLocalizer Localizer

@{
	ViewData["Title"] = @Localizer["MyProfile"];
}

<!-- Link to external CSS file -->
<link rel="stylesheet" href="~/css/user-profile.css" asp-append-version="true" />

<!-- Banner -->
<div class="profile-banner position-relative" style="background-image: url('@(Model.Banner ?? "/image/default-banner.jpg")');">
	<div class="profile-banner-overlay"></div>
</div>

<div class="container mt-4">
	<div class="row">
		<!-- Left Panel (Avatar & Info) -->
		<div class="col-md-4">
					<div class="profile-card text-center">
			<div class="avatar-container">
				<img src="@(Model.Avatar != null ? Model.Avatar : Url.Content("~/image/default-avatar.png"))"
					 class="profile-avatar rounded-circle" alt="Avatar">
				<div class="avatar-edit-overlay">
					<a asp-controller="User" asp-action="EditProfile" class="btn-edit-avatar" title="@Localizer["EditProfile"]">
						<i class="bi bi-pencil-square"></i>
					</a>
				</div>
			</div>
			<h3 class="mt-3">@Model.DisplayName</h3>
				<p class="text-muted">@Model.Bio</p>

				<ul class="list-group mt-3">
					<li class="list-group-item"><strong>@Localizer["Email"]:</strong> @Model.Email</li>
					<li class="list-group-item"><strong>@Localizer["JoinDate"]:</strong> @Model.CreatedAt.ToString("dd/MM/yyyy")</li>
					<li class="list-group-item"><strong>@Localizer["DateOfBirth"]:</strong> @(Model.DateOfBirth?.ToString("dd/MM/yyyy") ?? "Not Updated")</li>
					<li class="list-group-item"><strong>@Localizer["Gender"]:</strong> @(Model.Gender?.ToString() ?? "Unknown")</li>
				</ul>
			</div>
		</div>

		<!-- Right Panel (Statistics & Stories) -->
		<div class="col-md-8">
			<div class="profile-stats mt-3">
				<div class="d-flex justify-content-between flex-wrap gap-3">
					<div class="stat-box">
						<h4>@Model.TotalUploadedStories</h4>
						<p>@Localizer["UploadedStories"]</p>
					</div>
					<div class="stat-box">
						<h4>@Model.TotalFollowers</h4>
						<p>@Localizer["Followers"]</p>
					</div>
					<div class="stat-box">
						<h4>@Model.TotalFollowings</h4>
						<p>@Localizer["Following"]</p>
					</div>
					<div class="stat-box">
						<h4>@Model.TotalComments</h4>
						<p>@Localizer["Comments"]</p>
					</div>
				</div>
			</div>

			<!-- Stories Section -->
			<div class="mt-4">
				<h5 class="section-title">@Localizer["UploadedStories"]</h5>
				@if (Model.Stories.Any())
				{
					<div class="row">
						@foreach (var story in Model.Stories.Where(s => s.Status == PBL3.Models.StoryModel.StoryStatus.Active || s.Status == StoryModel.StoryStatus.Completed))
						{
							<div class="col-md-6">
								<a href="@Url.Action("View", "Story", new { id = story.StoryID })" class="story-card text-decoration-none">
                                    <img src="@story.Cover" class="story-cover" alt="@story.Title">
                                    <div class="story-info">
                                        <h6>@story.Title</h6>
                                        <p><strong>@Localizer["Chapter"]:</strong> @story.TotalChapters</p>
                                        <p><strong>@Localizer["Status"]:</strong> @Localizer[story.Status.ToString()]</p>
                                    </div>
                                </a>
							</div>
						}
					</div>
				}
				else
				{
					<p class="text-muted">@Localizer["NoStories"]</p>
				}
			</div>
		</div>
	</div>
</div>
